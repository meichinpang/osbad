<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="osbad.modval" href="../modval/index.html" /><link rel="prev" title="osbad.hyperparam" href="../hyperparam/index.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>osbad.model - osbad 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">osbad 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  <span class="sidebar-brand-text">osbad 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../dataset.html">Datasets Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Datasets Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../severson.html">Data-driven Prediction of Battery Cycle Life Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tohoku.html">Tohoku Dataset</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../models.html">Models Guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Models Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../iforest_example.html">Example: Benchmarking Isolation Forest with Probabilistic Outliers Prediction</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index.html">osbad</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of osbad</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../config/index.html">osbad.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database/index.html">osbad.database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hyperparam/index.html">osbad.hyperparam</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">osbad.model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modval/index.html">osbad.modval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scaler/index.html">osbad.scaler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html">osbad.stats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../viz/index.html">osbad.viz</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../_sources/autoapi/osbad/model/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-osbad.model">
<span id="osbad-model"></span><h1>osbad.model<a class="headerlink" href="#module-osbad.model" title="Link to this heading">¶</a></h1>
<p>Utilities for anomaly detection benchmarking on battery cell data.</p>
<p>This module provides the <a class="reference internal" href="#osbad.model.ModelRunner" title="osbad.model.ModelRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelRunner</span></code></a> class to orchestrate data
preparation, prediction, evaluation, and visualization for a single cell.
It supports several PyOD models via the <a class="reference internal" href="#osbad.model.PyODModelType" title="osbad.model.PyODModelType"><code class="xref py py-data docutils literal notranslate"><span class="pre">PyODModelType</span></code></a> type alias
and produces publication-ready figures saved per cell in an artifacts
directory.</p>
<dl class="simple">
<dt>Key features:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">create_model_x_input</span></code>: Extracts selected feature columns from the
input DataFrame and stores them as <code class="docutils literal notranslate"><span class="pre">self.Xdata</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pred_outlier_indices_from_proba</span></code>: Identifies indices of predicted
outliers based on probability outputs and a decision threshold.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">evaluate_indices</span></code>: Compares predicted outliers against benchmark
labels and computes recall and precision scores.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">create_2d_mesh_grid</span></code>: Builds a 2D mesh grid from the first two
features of <code class="docutils literal notranslate"><span class="pre">self.Xdata</span></code> for plotting decision surfaces.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_anomaly_score_map</span></code>: Fits a PyOD model, visualizes anomaly
probabilities with a decision boundary, highlights predicted outliers,
and saves the resulting figure to the cell’s artifact directory.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">osbad.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelRunner</span>
</pre></div>
</div>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="osbad.model.SELECTED_FEATURE_COLS">
<span class="sig-prename descclassname"><span class="pre">osbad.model.</span></span><span class="sig-name descname"><span class="pre">SELECTED_FEATURE_COLS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('log_max_diff_dQ',</span> <span class="pre">'log_max_diff_dV')</span></em><a class="headerlink" href="#osbad.model.SELECTED_FEATURE_COLS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="osbad.model.PyODModelType">
<span class="sig-prename descclassname"><span class="pre">osbad.model.</span></span><span class="sig-name descname"><span class="pre">PyODModelType</span></span><a class="headerlink" href="#osbad.model.PyODModelType" title="Link to this definition">¶</a></dt>
<dd><p>Type alias for supported PyOD anomaly detection models.</p>
<p>This alias groups together the most commonly used PyOD estimators for
outlier detection. It allows functions and methods to accept any of
these model types without explicitly listing each one in the type
annotations.</p>
<dl class="simple">
<dt>Models included:</dt><dd><ul class="simple">
<li><p>IForest (Isolation Forest)</p></li>
<li><p>KNN (k-Nearest Neighbors)</p></li>
<li><p>GMM (Gaussian Mixture Model)</p></li>
<li><p>LOF (Local Outlier Factor)</p></li>
<li><p>PCA (Principal Component Analysis for outliers)</p></li>
<li><p>AutoEncoder (Neural-network-based autoencoder for anomalies)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="osbad.model.ModelRunner">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">osbad.model.</span></span><span class="sig-name descname"><span class="pre">ModelRunner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_input_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fireducks.pandas.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_feature_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#osbad.model.ModelRunner" title="Link to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="osbad.model.ModelRunner.df_input_features">
<span class="sig-name descname"><span class="pre">df_input_features</span></span><a class="headerlink" href="#osbad.model.ModelRunner.df_input_features" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="osbad.model.ModelRunner.selected_features">
<span class="sig-name descname"><span class="pre">selected_features</span></span><a class="headerlink" href="#osbad.model.ModelRunner.selected_features" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="osbad.model.ModelRunner.create_model_x_input">
<span class="sig-name descname"><span class="pre">create_model_x_input</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#osbad.model.ModelRunner.create_model_x_input" title="Link to this definition">¶</a></dt>
<dd><p>Extract selected feature columns as a NumPy array.</p>
<p>This method selects the feature columns specified in
<code class="docutils literal notranslate"><span class="pre">self.selected_features</span></code> from the input DataFrame
<code class="docutils literal notranslate"><span class="pre">self.df_input_features</span></code>. The values are converted into a NumPy
array and stored in <code class="docutils literal notranslate"><span class="pre">self.Xdata</span></code> for downstream model training and
visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of shape (n_samples, n_features) containing the
selected feature values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">selected_feature_cols</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;log_max_diff_dQ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;log_max_diff_dV&quot;</span><span class="p">)</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">ModelRunner</span><span class="p">(</span>
    <span class="n">cell_label</span><span class="o">=</span><span class="n">selected_cell_label</span><span class="p">,</span>
    <span class="n">df_input_features</span><span class="o">=</span><span class="n">df_features_per_cell</span><span class="p">,</span>
    <span class="n">selected_feature_cols</span><span class="o">=</span><span class="n">selected_feature_cols</span>
<span class="p">)</span>

<span class="n">Xdata</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">create_model_x_input</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="osbad.model.ModelRunner.pred_outlier_indices_from_proba">
<span class="sig-name descname"><span class="pre">pred_outlier_indices_from_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proba</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#osbad.model.ModelRunner.pred_outlier_indices_from_proba" title="Link to this definition">¶</a></dt>
<dd><p>Identify outlier sample indices from probability predictions.</p>
<p>In PyOD, probability output has shape (n_samples, 2), where:</p>
<ul class="simple">
<li><p>column 0 = inlier probability</p></li>
<li><p>column 1 = outlier probability</p></li>
</ul>
<p>This function selects all indices where the outlier probability is
greater than or equal to the given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proba</strong> (<em>np.ndarray</em>) – Array of shape (n_samples, 2) with predicted probabilities.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Probability threshold above which a sample is flagged
as outlier.</p></li>
<li><p><strong>outlier_col</strong> (<em>int</em><em>, </em><em>optional</em>) – Column index for outlier probability. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of indices for samples classified as outliers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="osbad.model.ModelRunner.evaluate_indices">
<span class="sig-name descname"><span class="pre">evaluate_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_benchmark_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fireducks.pandas.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#osbad.model.ModelRunner.evaluate_indices" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate predicted outlier indices against benchmark labels.</p>
<p>Uses <code class="docutils literal notranslate"><span class="pre">modval.evaluate_pred_outliers</span></code> to align predicted outlier
indices with the benchmark dataset. The resulting DataFrame is
expected to contain the columns <code class="docutils literal notranslate"><span class="pre">true_outlier</span></code> and
<code class="docutils literal notranslate"><span class="pre">pred_outlier</span></code>. Recall and precision are then computed from
these columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_benchmark_dataset</strong> (<em>pd.DataFrame</em>) – Benchmark dataset containing ground-truth outlier labels.</p></li>
<li><p><strong>pred_indices</strong> (<em>np.ndarray</em>) – Indices of predicted outliers from the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>recall: Fraction of true outliers correctly identified.</p></li>
<li><p>precision: Fraction of predicted outliers that are true.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, float]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both recall and precision use <code class="docutils literal notranslate"><span class="pre">zero_division=0</span></code>. This means
that if there is a zero division, for example when the denominator
is zero (TP + FP = 0 for precision) or (TP + FN = 0 for recall),
the calculated <code class="docutils literal notranslate"><span class="pre">recall_score</span></code> or <code class="docutils literal notranslate"><span class="pre">precision_score</span></code>
will be zero.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="osbad.model.ModelRunner.create_2d_mesh_grid">
<span class="sig-name descname"><span class="pre">create_2d_mesh_grid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#osbad.model.ModelRunner.create_2d_mesh_grid" title="Link to this definition">¶</a></dt>
<dd><p>Create a 2D mesh grid for visualization of anomaly scores.</p>
<p>This function generates a square mesh grid covering the range of the
first two features in <code class="docutils literal notranslate"><span class="pre">self.Xdata</span></code>. The grid is expanded by ±1 unit
beyond the min and max values to ensure full coverage. The resulting
grid can be used for plotting decision boundaries and anomaly score
heatmaps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>xx (np.ndarray): 2D array of x-coordinates.</p></li>
<li><p>yy (np.ndarray): 2D array of y-coordinates.</p></li>
<li><p>meshgrid (np.ndarray): Flattened 2D grid of shape
(n_points, 2) where each row is a (x, y) coordinate pair.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="osbad.model.ModelRunner.predict_anomaly_score_map">
<span class="sig-name descname"><span class="pre">predict_anomaly_score_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selected_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyODModelType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xoutliers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fireducks.pandas.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">youtliers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">fireducks.pandas.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_outliers_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#osbad.model.ModelRunner.predict_anomaly_score_map" title="Link to this definition">¶</a></dt>
<dd><p>Plot a 2D anomaly score map with decision boundaries.</p>
<p>This function fits the selected PyOD model to the dataset and
visualizes the predicted anomaly scores across a 2D mesh grid.
It creates a contour plot showing anomaly probabilities, a dashed
decision boundary at the specified threshold, and highlights the
predicted anomalous cycles. Annotations and a legend are added to
label outliers, and the figure is saved in the artifacts directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selected_model</strong> (<em>PyODModelType</em>) – Trained PyOD model used to predict anomaly scores.</p></li>
<li><p><strong>model_name</strong> (<em>str</em>) – Name of the model, used as the plot title and
in the output filename.</p></li>
<li><p><strong>xoutliers</strong> (<em>pd.Series</em>) – x-coordinates of predicted anomalous
samples.</p></li>
<li><p><strong>youtliers</strong> (<em>pd.Series</em>) – y-coordinates of predicted anomalous
samples.</p></li>
<li><p><strong>pred_outliers_index</strong> (<em>np.ndarray</em>) – Indices of the predicted
anomalous samples.</p></li>
<li><p><strong>threshold</strong> (<em>np.float64</em><em>, </em><em>optional</em>) – Probability threshold for the
anomaly decision boundary. Defaults to 0.7.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axes object containing the anomaly score
contour plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">axplot</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">predict_anomaly_score_map</span><span class="p">(</span>
    <span class="n">selected_model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;Isolation Forest&quot;</span><span class="p">,</span>
    <span class="n">xoutliers</span><span class="o">=</span><span class="n">df_outliers_pred</span><span class="p">[</span><span class="s2">&quot;log_max_diff_dQ&quot;</span><span class="p">],</span>
    <span class="n">youtliers</span><span class="o">=</span><span class="n">df_outliers_pred</span><span class="p">[</span><span class="s2">&quot;log_max_diff_dV&quot;</span><span class="p">],</span>
    <span class="n">pred_outliers_index</span><span class="o">=</span><span class="n">pred_outlier_indices</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="n">param_dict</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Currently supported PyOD models in this benchmarking study are:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pyod.models.iforest.IForest</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyod.models.knn.KNN</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyod.models.gmm.GMM</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyod.models.lof.LOF</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyod.models.pca.PCA</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyod.models.auto_encoder.Autoencoder</span></code></p></li>
</ul>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../modval/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">osbad.modval</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../hyperparam/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">osbad.hyperparam</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Mei-Chin Pang
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">osbad.model</a><ul>
<li><a class="reference internal" href="#module-contents">Module Contents</a><ul>
<li><a class="reference internal" href="#osbad.model.SELECTED_FEATURE_COLS"><code class="docutils literal notranslate"><span class="pre">SELECTED_FEATURE_COLS</span></code></a></li>
<li><a class="reference internal" href="#osbad.model.PyODModelType"><code class="docutils literal notranslate"><span class="pre">PyODModelType</span></code></a></li>
<li><a class="reference internal" href="#osbad.model.ModelRunner"><code class="docutils literal notranslate"><span class="pre">ModelRunner</span></code></a><ul>
<li><a class="reference internal" href="#osbad.model.ModelRunner.df_input_features"><code class="docutils literal notranslate"><span class="pre">ModelRunner.df_input_features</span></code></a></li>
<li><a class="reference internal" href="#osbad.model.ModelRunner.selected_features"><code class="docutils literal notranslate"><span class="pre">ModelRunner.selected_features</span></code></a></li>
<li><a class="reference internal" href="#osbad.model.ModelRunner.create_model_x_input"><code class="docutils literal notranslate"><span class="pre">ModelRunner.create_model_x_input()</span></code></a></li>
<li><a class="reference internal" href="#osbad.model.ModelRunner.pred_outlier_indices_from_proba"><code class="docutils literal notranslate"><span class="pre">ModelRunner.pred_outlier_indices_from_proba()</span></code></a></li>
<li><a class="reference internal" href="#osbad.model.ModelRunner.evaluate_indices"><code class="docutils literal notranslate"><span class="pre">ModelRunner.evaluate_indices()</span></code></a></li>
<li><a class="reference internal" href="#osbad.model.ModelRunner.create_2d_mesh_grid"><code class="docutils literal notranslate"><span class="pre">ModelRunner.create_2d_mesh_grid()</span></code></a></li>
<li><a class="reference internal" href="#osbad.model.ModelRunner.predict_anomaly_score_map"><code class="docutils literal notranslate"><span class="pre">ModelRunner.predict_anomaly_score_map()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>